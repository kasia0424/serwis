{% extends 'base.twig' %}

{% block title %}Ads list{% endblock %}

{% block content %}

    <h1 class="text-center">
        Ads list
    </h1>
    
    {% if is_granted('ROLE_USER') %}
        <h4>
            <a href="{{ url('/ads/add') }}" title="Add ad" class="label label-primary text-uppercase">
                Add ad
            </a>
        </h4>
    {% endif %}

    {%  if ads|length > 0 %}
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Text</th>
                    <th>Date of post</th>
                    <th>Category</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
            {% for ad in ads %}
                <tr>
                    <td>{{ ad.title|e }}</td>
                    <td>{{ ad.text|e }}</td>
                    <td>{{ ad.postDate|e }}</td>
                    <td><a href="{{ url('/categories/view', {'id': ad.category_id}) }}" title="Category">{{ ad.category|e }}</a></td>
                    <td>
                        <a href="{{ url('/ads/view', {'id': ad.id}) }}" title="View ad" class="btn btn-default btn-lg">View details</a>
                        {% if is_granted('ROLE_ADMIN') or loggedUser == ad.user_id %}
                            <a href="{{ url('/ads/edit', {'id': ad.id}) }}" title="Edit ad" class="btn btn-default btn-lg">Edit</a>
                            <a href="{{ url('/ads/delete', {'id': ad.id}) }}" title="Delete ad" onclick="return confirm('Sure you want to delete this ad?')" class="btn btn-default btn-lg">Delete</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>
            Ads not found.
        </p>
    {% endif %}
    <div>
        {% if paginator.page > 1 %}
            {% set previous = (paginator.page - 1) %}
            <a href="{{ url('/ads/', {'page': previous}) }}" title="{{ 'previous page'|trans }}"><img src="{{ app.request.basepath }}/media/arrow.png"  alt="brak arrow" height="15" width="50" style="transform:rotate(180deg);"></a>
        {%  endif %}

        {% if paginator.page < paginator.pagesCount %}
            {% set next = (paginator.page + 1) %}
            <a href="{{ url('/ads/', {'page': next}) }}" title="{{ 'next page'|trans }}" class="pull-right"><img src="{{ app.request.basepath }}/media/arrow.png" alt="brak arrow" height="15" width="50"></a>
        {% endif  %}
    </div>
{% endblock %}
